<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Exercise Generator</title>
  <!-- Добавлена иконка сайта -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Ccircle cx='24' cy='24' r='22' fill='%232563eb'/%3E%3Ctext x='24' y='30' font-size='20' text-anchor='middle' fill='white' font-family='Arial, sans-serif'%3EEG%3C/text%3E%3C/svg%3E">
  <style>
    /* ===== Тема и базовые переменные ===== */
    :root {
      --bg: #ffffff;
      --ink: #1f2937;
      --muted: #6b7280;
      --primary: #2563eb;
      --teal: #14b8a6;
      --page-margin: 12mm;
    }

    /* ===== Базовая раскладка страницы ===== */
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--ink);
      font-family: "Inter", system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
      line-height: 1.35;
    }

    .page {
      width: 210mm;
      min-height: 297mm;
      margin: 0 auto;
      padding: var(--page-margin);
      display: grid;
      grid-template-rows: auto auto auto 1fr;
      gap: 8mm;
      background: var(--bg);
    }

    header h1 {
      margin: 0 0 2mm 0;
      font-size: 20pt;
    }
    header p { margin: 0; color: var(--muted); }
    .tool-title { margin: 0 0 2mm 0; font-size: 14pt; }

    .controls {
      display: flex;
      gap: 6mm;
      align-items: center;
      flex-wrap: wrap;
    }
    .controls button, .controls select {
      appearance: none;
      border: 1px solid #e5e7eb;
      border-radius: 10mm;
      padding: 4mm 8mm;
      font-size: 11pt;
      cursor: pointer;
      background: #fff;
      color: var(--ink);
      box-shadow: 0 1mm 2mm rgba(0,0,0,0.05);
    }
    .controls button.primary { color: #fff; background: var(--primary); border-color: var(--primary); }
    .controls button.secondary { color: #fff; background: var(--teal); border-color: var(--teal); }

    .tool {
      display: none;
    }
    .tool.active { display: block; }

    /* ===== Стили инструмента I Spy ===== */
    .sheet { position: relative; border: 1px dashed #e5e7eb; border-radius: 3mm; padding: 4mm; overflow: hidden; }
    .sheet { background:
      radial-gradient( circle at 20% 10%, rgba(37,99,235,0.06), transparent 45% ),
      radial-gradient( circle at 80% 30%, rgba(139,92,246,0.07), transparent 45% ),
      radial-gradient( circle at 30% 85%, rgba(20,184,166,0.06), transparent 45% ); }
    .playfield { position: relative; width: 100%; height: 0; padding-bottom: 65%; background: #ffffffcc; border-radius: 2mm; overflow: hidden; }
    .settings { display: grid; grid-template-columns: repeat(3, 1fr); gap: 6mm 10mm; align-items: center; }
    .cfg-item { display: grid; grid-template-columns: 12mm 1fr 24mm; gap: 3mm; align-items: center; }
    .cfg-item input[type="number"] { width: 24mm; padding: 2mm 2mm; font-size: 11pt; }
    .footer { display: grid; grid-template-columns: repeat(3, 1fr); gap: 6mm 10mm; align-items: center; }
    .count-item { display: grid; grid-template-columns: 12mm 1fr 28mm; gap: 3mm; align-items: center; }
    .count-item .mini { width: 12mm; height: 12mm; display: inline-block; }
    .line { border-bottom: 1px solid #94a3b8; height: 0; }
    .play-table { position: absolute; inset: 0; width: 100%; height: 100%; border-collapse: collapse; table-layout: fixed; }
    .play-table td { border: 1px solid #e5e7eb; text-align: center; vertical-align: middle; padding: 0; }
    .cell-icon { width: 100%; height: 100%; display: grid; place-items: center; }
    .cell-icon svg { width: 78%; height: auto; display: block; }

    /* ===== Стили инструмента Карточки (Singular/Plural) ===== */
    .pairs {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      grid-template-rows: repeat(3, auto);
      gap: 6mm;
      justify-items: stretch;
      align-items: stretch;
    }
    .pair {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 3mm;
      align-items: stretch;
      height: 100%;
    }
    .card {
      border: 1px solid #e5e7eb;
      border-radius: 2mm;
      background: #ffffff;
      box-shadow: 0 1mm 2mm rgba(0,0,0,0.06);
      display: grid;
      grid-template-rows: 1fr auto;
      overflow: hidden;
      min-height: 36mm;
      max-height: 44mm;
    }
    .visual {
      display: grid;
      place-items: center;
      padding: 3mm;
      min-height: 22mm;
      background:
        radial-gradient( circle at 20% 10%, rgba(37,99,235,0.06), transparent 45% ),
        radial-gradient( circle at 80% 30%, rgba(139,92,246,0.07), transparent 45% ),
        radial-gradient( circle at 30% 85%, rgba(20,184,166,0.06), transparent 45% );
      /* Добавлено ограничение для предотвращения переполнения */
      box-sizing: border-box;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }
    /* Исправление для сетки мини-иконок, чтобы не вылезали за край */
    .visual.grid {
      --cell: 8mm;
      --gap: 1.2mm;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(var(--cell), 1fr));
      gap: var(--gap);
      width: 100%;
      max-height: 100%;
      overflow-y: auto;
      justify-items: center;
      align-items: center;
      box-sizing: border-box;
      padding: 1.5mm;
    }
    .visual.grid .mini svg {
      width: 100%;
      height: auto;
      max-width: 8mm;
      max-height: 8mm;
      display: block;
    }
    .single svg { width: 48%; height: auto; display: block; }
    .grid {
      --cell: 10mm;
      --gap: 2mm;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(var(--cell), 1fr));
      gap: var(--gap);
      width: 100%;
      padding: 2mm;
    }
    .grid .mini svg { width: 100%; height: auto; display: block; }
    .label {
      padding: 2mm 3mm;
      border-top: 1px solid #e5e7eb;
      text-align: center;
      font-size: 10pt;
      font-weight: 600;
    }

    /* ===== Печать (A4) ===== */
    @media print {
      @page { size: A4 portrait; margin: var(--page-margin); }
      body { background: #fff; }
      .controls, .settings.global { display: none !important; }
      .page { width: auto; min-height: auto; padding: 0; gap: 8mm; }
      .pairs { gap: 4mm; }
      .card { box-shadow: none; }
    }
  </style>
</head>
<body>
  <div class="page">
    <header>
      <h1>Exercise Generator</h1>
      <p>Choose a tool and generate an exercise for printing.</p>
    </header>

    <div class="controls settings global">
      <label for="tool">Tool:</label>
      <select id="tool">
        <option value="spy">I Spy</option>
        <option value="pairs">Singular ↔ Plural</option>
      </select>
      <button id="regen" class="primary">Generate</button>
      <button id="print" class="secondary">Print</button>
    </div>

    <!-- I SPY TOOL -->
    <section id="tool-spy" class="tool">
      <h2 class="tool-title">I Spy: find the items</h2>
      <div id="spy-settings" class="settings" aria-label="Item count settings"></div>
      <section class="sheet">
        <div id="spy-playfield" class="playfield" aria-label="Playfield with items"></div>
      </section>
      <section id="spy-footer" class="footer" aria-label="Lines to write found counts"></section>
    </section>

    <!-- PAIRS TOOL -->
    <section id="tool-pairs" class="tool">
      <h2 class="tool-title">Singular ↔ Plural — practice cards</h2>
      <div id="pairs-settings" class="settings" aria-label="Pairs count settings"></div>
      <section id="pairs" class="pairs" aria-label="Singular and plural pairs"></section>
    </section>
  </div>

  <script src="svg_items.js"></script>
  <script src="shared.js"></script>
  <script src="spy.js"></script>
  <script src="pairs.js"></script>
  <script>
    const selectTool = document.getElementById('tool');
    const btnRegen = document.getElementById('regen');
    const btnPrint = document.getElementById('print');

    function switchTool(value) {
      document.querySelectorAll('.tool').forEach(t => t.classList.remove('active'));
      const id = value === 'pairs' ? 'tool-pairs' : 'tool-spy';
      document.getElementById(id).classList.add('active');
    }

    function regenerate() {
      if (selectTool.value === 'pairs') renderPairs();
      else renderSpy();
    }

    selectTool.addEventListener('change', () => {
      switchTool(selectTool.value);
      regenerate();
    });

    btnPrint.addEventListener('click', () => window.print());
    btnRegen.addEventListener('click', regenerate);

    window.addEventListener('load', () => {
      switchTool(selectTool.value);
      regenerate();
    });

    window.addEventListener('resize', debounce(() => {
      regenerate();
    }, 150));
  </script>
</body>
</html>


